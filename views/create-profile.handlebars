{{>nav}}
<link href="https://cdn.jsdelivr.net/npm/smartwizard@5/dist/css/smart_wizard_all.min.css" rel="stylesheet" type="text/css" />
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/smartwizard@5/dist/js/jquery.smartWizard.min.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>


<script type="text/javascript">
    //function checkSelected() {
    //    let id = document.getElementById("instruments").value;
    //    let val = document.getElementById("instruments").text;

    //    let opts = document.getElementById('instrument-list').childNodes;
    //    for (let i = 0; i < opts.length; i++) {
    //        if (opts[i].text === val) {
    //            addSelection(id, val);
    //            break;
    //        }
    //    }
    //}

    function addSelection(id, inst) {
        let selection = document.getElementById("instrument-selection");
        let item = document.createElement('div');
        item.className = 'instrument-selection-item';
        item.id = id;
        item.innerHTML = `            <div class="delete-selection" onclick="remove(this)" style="float:right; color: red">X</div>
            <div class="instrument-selection-text" data-instID>${inst}</div>
            <select class="selection-level" name="selection-level" id="${id}-level">
                <option disabled selected value> -- Skill Level -- </option>
                <option value="1">Beginner</option>
                <option value="2">Intermediate</option>
                <option value="3">Advanced</option>
                <option value="4">Expert</option>
                <option value="5">Master</option>
            </select>
        `;

        selection.appendChild(item);
        $("#smartwizard").find(".tab-content").css("height", "auto"); //resize container
    }

    function remove(item) {
        item.parentNode.remove();
    }

    $(document).ready(function () {
        $('#instrument-list').select2().on('select2:select', function (e) {
            var selectedOption = $("#instrument-list").select2('data')[0];
            console.log(selectedOption);
            addSelection(selectedOption.id, (selectedOption.text));
        });

        // SmartWizard initialize
        $('#smartwizard').smartWizard({
            justified: true, // Nav menu justification. true/false
            autoAdjustHeight: true, // Automatically adjust content height,
            showNextButton: false, // show/hide a Next button
            showPreviousButton: false, // show/hide a Previous button
        });


        $("#step-1-finish").click(function () {
            
            var data2Send = [];
            $(".instrument-selection-item").each(function () {
                var instrumentID = $(this).attr("id");
                var levelID = $(this).find("select[name='selection-level']").val();
                data2Send.push({ InstrumentID: instrumentID, LevelID: levelID});
            });

            if (data2Send.length < 1) {
                alert("Select an instrument");
            } else {
                $.ajax({
                    url: '/profile/instrument/add',
                    type: 'POST',
                    data: {
                        'instruments': data2Send
                    },
                    dataType: 'json',
                    success: function (data) {
                        $('#smartwizard').smartWizard("next"); //if all is good, go to next step
                    },
                    error: function (request, error) {
                        alert("Request: " + JSON.stringify(request));
                    }
                });
            }
        });

        $("#step-2-finish").click(function () {
            $('#smartwizard').smartWizard("next"); //if all is good, go to next step
        });


        $("#createProfileButton").click(function () {

        });

    });

</script>
<main>
    <div class="main-container">
        <div class="create-profile-header">
            <h1>Welcome to the club, {{user.FirstName}}!</h1>
            <p>You're on your way to connect with other awesome musicians like yourself!</p>
            <p>Let's find out a little bit more about you first.</p>
        </div>
        <div id="smartwizard">
            <ul class="nav" style="margin-left: 0">
                <li>
                    <a class="nav-link" href="#step-1">
                        Step 1: Instruments
                    </a>
                </li>
                <li>
                    <a class="nav-link" href="#step-2">
                        Step 2: Samples
                    </a>
                </li>
                <li>
                    <a class="nav-link" href="#step-3">
                        Step 3: Basic Info
                    </a>
                </li>
            </ul>

            <div class="tab-content">
                <div id="step-1" class="tab-pane" role="tabpanel">
                    <form>
                        <table>
                            <tr>
                                <h3>Step 1: Instruments</h3>
                                <td>
                                    <label for="instruments">
                                        What instrument(s) do you play?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <!--<input placeholder="Select an Instrument" list="instrument-list" type="text" id="instruments" oninput="checkSelected()">-->
                                    <select id="instrument-list">
                                        {{#each instruments}}
                                        <option value="{{this.InstrumentKey}}">{{this.Instrument}}</option>
                                        {{/each}}
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div id="instrument-selection">

                                    </div>
                                </td>
                            </tr>
                        </table>
                    </form>
                    <div class="toolbar toolbar-bottom" role="toolbar" style="text-align: right;">
                        <button class="btn sw-btn-next disabled" type="button" id="step-1-finish">Next</button>
                    </div>
                </div>
                <div id="step-2" class="tab-pane" role="tabpanel">
                    We will add this next sprint! Just continue on for now...
                    <div class="toolbar toolbar-bottom" role="toolbar" style="text-align: right;">
                        <button class="btn sw-btn-next disabled" type="button" id="step-2-finish">Next</button>
                    </div>
                </div>
                <div id="step-3" class="tab-pane" role="tabpanel">
                    <form id="step-3-form">
                        <table>
                            <h3>Step 3: Basic Info</h3>
                            <tr>
                                <td>
                                    <label for="ArtistName">
                                        What is your band or artist name?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input placeholder="Band or artist name" type="text" id="ArtistName">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="zipCode">
                                        What is your zip code?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input placeholder="Zip code" type="text" pattern="[0-9]{5}" id="zipCode" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="phoneNumber">
                                        What is the best phone number to reach you at?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input placeholder="Phone number" type="number" id="phoneNumber" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="webAddress">
                                        Do you have a website?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input placeholder="Website URL" type="text" id="webAddress">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label>
                                        Are you currently looking for a spot in a band?
                                    </label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="radio" id="yesLooking" name="lookingForWork" value="yes" checked>
                                    <label for="yesLooking">Yes</label>
                                    <input type="radio" id="notLooking" name="lookingForWork" value="no">
                                    <label for="notLooking">No</label>
                                </td>
                            </tr>
                        </table>
                        <div class="create-profile">
                            <button class="button secondary hollow medium expanded" id="createProfileButton" href="#">Create Your Profile</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>


        <!--<div class="orbit" role="region" aria-label="Create Profile Orbit" data-orbit data-auto-play="false">
            <div class="orbit-wrapper">
                <div class="orbit-controls">
                    <button class="orbit-previous"><span class="show-for-sr">Previous Slide</span>&#9664;&#xFE0E;</button>
                    <button class="orbit-next"><span class="show-for-sr">Next Slide</span>&#9654;&#xFE0E;</button>
                </div>
                <ul class="orbit-container">
                    <li class="is-active orbit-slide">
                        <div id="profile-form">
                            <form>
                                <table>
                                    <tr>
                                        <h3>Step 1: Instruments</h3>
                                        <td>
                                            <label for="instruments">
                                                What instrument(s) do you play?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input placeholder="Select an Instrument" list="instrument-list" type="text" id="instruments" oninput="checkSelected()">
                                            <datalist id="instrument-list">
                                                {{#each instruments}}
                                                <option value="{{Instrument}}">
                                                    {{/each}}
                                            </datalist>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div id="instrument-selection">

                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </div>
                    </li>
                    <li class="orbit-slide">
                        <div id="profile-form">
                            <form>
                                <table>
                                    <tr>
                                        <h3>Step 2: Samples</h3>
                                        <td>
                                            <label for="workSamples">
                                                Upload a sample of your work
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="file" id="workSamples">
                                        </td>
                                    </tr>
                                    <tr>
                                    </tr>
                                </table>
                            </form>
                        </div>
                    </li>
                    <li class="orbit-slide">
                        <div id="profile-form">
                            <form>
                                <table>
                                    <h3>Step 3: Basic Info</h3>
                                    <tr>
                                        <td>
                                            <label for="ArtistName">
                                                What is your band or artist name?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input placeholder="Band or artist name" type="text" id="ArtistName">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label for="zipCode">
                                                What is your zip code?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input placeholder="Zip code" type="text" pattern="[0-9]{5}" id="zipCode" required>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label for="phoneNumber">
                                                What is the best phone number to reach you at?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input placeholder="Phone number" type="number" id="phoneNumber" required>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label for="webAddress">
                                                Do you have a website?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input placeholder="Website URL" type="text" id="webAddress">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <label>
                                                Are you currently looking for a spot in a band?
                                            </label>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <input type="radio" id="yesLooking" name="lookingForWork" value="yes" checked>
                                            <label for="yesLooking">Yes</label>
                                            <input type="radio" id="notLooking" name="lookingForWork" value="no">
                                            <label for="notLooking">No</label>
                                        </td>
                                    </tr>
                                </table>
                                <div class="create-profile">
                                    <button class="button secondary hollow medium expanded" id="createProfileButton" href="#">Create Your Profile</button>
                                </div>
                            </form>
                        </div>
                    </li>
                </ul>
            </div>
        </div>-->
    </div>
</main>

